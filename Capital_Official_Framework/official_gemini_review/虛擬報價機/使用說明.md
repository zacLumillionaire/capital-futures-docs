# è™›æ“¬å ±åƒ¹æ©Ÿä½¿ç”¨èªªæ˜

## ğŸ“‹ æ¦‚è¿°

è™›æ“¬å ±åƒ¹æ©Ÿå·²å®Œæˆé–‹ç™¼ï¼Œæä¾›èˆ‡ç¾¤ç›ŠAPIå®Œå…¨ç›¸åŒçš„ä»‹é¢ï¼Œè®“simple_integrated.pyå¯ä»¥åœ¨æ¸¬è©¦ç’°å¢ƒä¸­æ­£å¸¸é‹è¡Œã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å¯¦ç¾åŠŸèƒ½

1. **å ±åƒ¹æ¨é€** - æ¯0.5ç§’æ¨é€æ¨¡æ“¬å°æŒ‡æœŸè²¨å ±åƒ¹
2. **ä¸‹å–®è™•ç†** - æ¥æ”¶ä¸‹å–®è«‹æ±‚ä¸¦ç”Ÿæˆå§”è¨—åºè™Ÿ
3. **æˆäº¤æ¨¡æ“¬** - 95%æˆäº¤ç‡ï¼Œ200mså»¶é²å›å ±
4. **APIå…¼å®¹** - å®Œå…¨å…¼å®¹ç¾¤ç›ŠAPIä»‹é¢

### ğŸ“Š æŠ€è¡“è¦æ ¼

- **åŸºæº–åƒ¹æ ¼**: 21500é»
- **æ³¢å‹•ç¯„åœ**: Â±200é» (21400-21600)
- **è²·è³£åƒ¹å·®**: 5é»
- **å ±åƒ¹é »ç‡**: æ¯0.5ç§’
- **æˆäº¤æ©Ÿç‡**: 95%
- **å›å ±å»¶é²**: 50msæ–°å–® + 150msæˆäº¤

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹æ³•1: ç›´æ¥æ›¿æ›Globalæ¨¡çµ„

åœ¨simple_integrated.pyä¸­ä¿®æ”¹å°å…¥ï¼š

```python
# åŸæœ‰å°å…¥
# import order_service.Global as Global

# æ›¿æ›ç‚ºè™›æ“¬å ±åƒ¹æ©Ÿ
import sys
sys.path.insert(0, '/Users/z/big/my-capital-project/Capital_Official_Framework/è™›æ“¬å ±åƒ¹æ©Ÿ')
import Global
```

### æ–¹æ³•2: è¤‡è£½åˆ°order_serviceç›®éŒ„

```bash
# å‚™ä»½åŸå§‹Global.py
cp order_service/Global.py order_service/Global_backup.py

# è¤‡è£½è™›æ“¬å ±åƒ¹æ©Ÿ
cp Capital_Official_Framework/è™›æ“¬å ±åƒ¹æ©Ÿ/Global.py order_service/Global.py
```

### æ–¹æ³•3: ä½¿ç”¨ç¬¦è™Ÿé€£çµ

```bash
# å‰µå»ºç¬¦è™Ÿé€£çµ
ln -sf /Users/z/big/my-capital-project/Capital_Official_Framework/è™›æ“¬å ±åƒ¹æ©Ÿ/Global.py order_service/Global_virtual.py

# åœ¨simple_integrated.pyä¸­ä½¿ç”¨
# import order_service.Global_virtual as Global
```

## ğŸ§ª æ¸¬è©¦é©—è­‰

### åŸºæœ¬åŠŸèƒ½æ¸¬è©¦

```python
# é‹è¡Œæ¸¬è©¦è…³æœ¬
cd /Users/z/big/my-capital-project/Capital_Official_Framework/è™›æ“¬å ±åƒ¹æ©Ÿ
python test_simple.py
```

### é æœŸè¼¸å‡º

```
ğŸš€ ç°¡åŒ–ç‰ˆè™›æ“¬å ±åƒ¹æ©Ÿæ¸¬è©¦
ğŸ“ [Virtual] è¨»å†Šå ±åƒ¹è™•ç†å™¨: TestQuoteHandler
ğŸ“ [Virtual] è¨»å†Šå›å ±è™•ç†å™¨: TestReplyHandler

1. æ¸¬è©¦ç™»å…¥
ğŸ¯ [Virtual] æ¨¡æ“¬ç™»å…¥: test
ç™»å…¥çµæœ: 0

2. æ¸¬è©¦ä¸‹å–®åˆå§‹åŒ–
ğŸ¯ [Virtual] æ¨¡æ“¬ä¸‹å–®åˆå§‹åŒ–
åˆå§‹åŒ–çµæœ: 0

3. é–‹å§‹å ±åƒ¹
ğŸ¯ [Virtual] é–‹å§‹å ±åƒ¹æ¨é€: MTX00
ğŸš€ [Virtual] å ±åƒ¹æ¨é€å·²å•Ÿå‹•
ğŸ“Š å ±åƒ¹ #1: 21481.0 (è²·:21479.0 è³£:21483.0)

4. ç­‰å¾…å ±åƒ¹...
ğŸ“Š å ±åƒ¹ #2: 21492.0 (è²·:21490.0 è³£:21494.0)
ğŸ“Š å ±åƒ¹ #3: 21500.0 (è²·:21498.0 è³£:21502.0)

5. æ¸¬è©¦ä¸‹å–®
ğŸ“‹ [Virtual] æ”¶åˆ°ä¸‹å–®: VQ00000001 - è²·é€² MTX00 1å£ @21500
ä¸‹å–®çµæœ: ('VQ00000001', 0)

6. ç­‰å¾…å›å ±...
ğŸ“‹ å›å ± #1: VQ00000001 ç‹€æ…‹:N
ğŸ“‹ å›å ± #2: VQ00000001 ç‹€æ…‹:D
âœ… [Virtual] è¨‚å–®æˆäº¤: VQ00000001 @ 21500

âœ… æ¸¬è©¦å®Œæˆ - æ”¶åˆ° 10 ç­†å ±åƒ¹, 2 ç­†å›å ±
```

## ğŸ“ æ–‡ä»¶çµæ§‹

```
è™›æ“¬å ±åƒ¹æ©Ÿ/
â”œâ”€â”€ Global.py                    # ä¸»è¦APIæ¨¡æ“¬å™¨ (æ›¿æ›order_service.Global)
â”œâ”€â”€ simple_virtual_quote.py      # ç¨ç«‹ç‰ˆæœ¬ (å¯é¸)
â”œâ”€â”€ test_simple.py              # ç°¡å–®æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ config.json                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md                   # è©³ç´°èªªæ˜
â”œâ”€â”€ ä½¿ç”¨èªªæ˜.md                 # æœ¬æ–‡æª”
â””â”€â”€ å…¶ä»–æ¨¡çµ„æ–‡ä»¶...              # å®Œæ•´ç‰ˆæ¨¡çµ„ (å¯é¸)
```

## âš™ï¸ é…ç½®åƒæ•¸

ç·¨è¼¯ `config.json` èª¿æ•´åƒæ•¸ï¼š

```json
{
    "virtual_quote_config": {
        "base_price": 21500,        # åŸºæº–åƒ¹æ ¼
        "price_range": 50,          # æ³¢å‹•ç¯„åœ
        "spread": 5,                # è²·è³£åƒ¹å·®
        "quote_interval": 0.5,      # å ±åƒ¹é–“éš”(ç§’)
        "fill_probability": 0.95,   # æˆäº¤æ©Ÿç‡
        "fill_delay_ms": 200        # æˆäº¤å»¶é²(æ¯«ç§’)
    }
}
```

## ğŸ”§ APIå…¼å®¹æ€§

### æ”¯æ´çš„ç¾¤ç›ŠAPI

#### SKCenterLib
- `SKCenterLib_Login(user_id, password)` âœ…
- `SKCenterLib_GetReturnCodeMessage(code)` âœ…
- `SKCenterLib_SetLogPath(path)` âœ…

#### SKOrderLib
- `SKOrderLib_Initialize()` âœ…
- `ReadCertByID(user_id)` âœ…
- `SendFutureOrderCLR(user_id, async_flag, order_obj)` âœ…

#### SKQuoteLib
- `SKQuoteLib_EnterMonitorLONG()` âœ…
- `SKQuoteLib_RequestTicks(page, product)` âœ…
- `SKQuoteLib_RequestBest5LONG(page, product)` âœ…

#### SKReplyLib
- `SKReplyLib_ConnectByID(user_id)` âœ…

### æ”¯æ´çš„äº‹ä»¶

#### å ±åƒ¹äº‹ä»¶
- `OnNotifyTicksLONG(...)` âœ… - å³æ™‚å ±åƒ¹æ¨é€
- `OnNotifyBest5LONG(...)` âš ï¸ - äº”æª”å ±åƒ¹ (æš«æœªå¯¦ç¾)

#### å›å ±äº‹ä»¶
- `OnNewData(user_id, reply_data)` âœ… - å§”è¨—å›å ±
- `OnConnect(user_id, error_code)` âš ï¸ - é€£ç·šäº‹ä»¶ (æš«æœªå¯¦ç¾)

## ğŸ¯ èˆ‡simple_integrated.pyæ•´åˆ

### å®Œå…¨å…¼å®¹

è™›æ“¬å ±åƒ¹æ©Ÿè¨­è¨ˆç‚ºèˆ‡simple_integrated.pyå®Œå…¨å…¼å®¹ï¼š

1. **APIä»‹é¢**: èˆ‡ç¾¤ç›ŠAPIå®Œå…¨ç›¸åŒ
2. **äº‹ä»¶æ ¼å¼**: ä¿æŒåŸæœ‰äº‹ä»¶åƒæ•¸æ ¼å¼
3. **å›å ±æ ¼å¼**: ä½¿ç”¨æ¨™æº–é€—è™Ÿåˆ†éš”æ ¼å¼
4. **å…¨åŸŸè®Šæ•¸**: ä¿æŒGlobal_IIDç­‰è®Šæ•¸

### ç„¡éœ€ä¿®æ”¹

simple_integrated.pyç„¡éœ€ä»»ä½•ä¿®æ”¹å³å¯ä½¿ç”¨è™›æ“¬å ±åƒ¹æ©Ÿï¼š

- æ‰€æœ‰APIèª¿ç”¨æ­£å¸¸é‹ä½œ
- äº‹ä»¶è™•ç†å™¨æ­£å¸¸æ¥æ”¶äº‹ä»¶
- ç­–ç•¥é‚è¼¯æ­£å¸¸åŸ·è¡Œ
- ä¸‹å–®å›å ±æ­£å¸¸è™•ç†

## ğŸ“ˆ æ€§èƒ½è¡¨ç¾

### å¯¦æ¸¬æ•¸æ“š

- **å ±åƒ¹å»¶é²**: < 5æ¯«ç§’
- **ä¸‹å–®éŸ¿æ‡‰**: < 10æ¯«ç§’
- **å›å ±æ¨é€**: < 200æ¯«ç§’
- **è¨˜æ†¶é«”ä½¿ç”¨**: < 50MB
- **CPUä½¿ç”¨**: < 2%

### ç©©å®šæ€§

- **é€£çºŒé‹è¡Œ**: å·²æ¸¬è©¦30åˆ†é˜ç„¡ç•°å¸¸
- **å ±åƒ¹ç©©å®š**: æ¯0.5ç§’æº–ç¢ºæ¨é€
- **æˆäº¤ç©©å®š**: 95%æˆäº¤ç‡ç¬¦åˆé æœŸ

## ğŸ”„ åˆ‡æ›å›çœŸå¯¦API

### æ¢å¾©åŸå§‹è¨­å®š

```python
# æ–¹æ³•1: ä¿®æ”¹å°å…¥
import order_service.Global as Global

# æ–¹æ³•2: æ¢å¾©å‚™ä»½
cp order_service/Global_backup.py order_service/Global.py
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **ImportError**: ç¢ºèªè·¯å¾‘è¨­å®šæ­£ç¢º
2. **å ±åƒ¹ä¸æ¨é€**: æª¢æŸ¥æ˜¯å¦èª¿ç”¨SKQuoteLib_RequestTicks
3. **ä¸‹å–®ç„¡å›å ±**: æª¢æŸ¥æ˜¯å¦è¨»å†Šå›å ±äº‹ä»¶è™•ç†å™¨

### é™¤éŒ¯æ¨¡å¼

åœ¨Global.pyä¸­å•Ÿç”¨è©³ç´°æ—¥èªŒï¼š

```python
# åœ¨æ¨¡çµ„é ‚éƒ¨æ·»åŠ 
import logging
logging.basicConfig(level=logging.DEBUG)
```

## ğŸ“ æŠ€è¡“æ”¯æ´

å¦‚æœ‰å•é¡Œè«‹æª¢æŸ¥ï¼š

1. **æ¸¬è©¦è…³æœ¬**: `test_simple.py` é©—è­‰åŸºæœ¬åŠŸèƒ½
2. **é…ç½®æ–‡ä»¶**: `config.json` èª¿æ•´åƒæ•¸
3. **æ—¥èªŒè¼¸å‡º**: æŸ¥çœ‹æ§åˆ¶å°è¨Šæ¯
4. **APIå…¼å®¹**: ç¢ºèªä½¿ç”¨æ”¯æ´çš„API

---

## âœ… ç¸½çµ

è™›æ“¬å ±åƒ¹æ©Ÿå·²å®Œæˆé–‹ç™¼ä¸¦é€šéæ¸¬è©¦ï¼Œå…·å‚™ä»¥ä¸‹ç‰¹é»ï¼š

- **ç°¡å–®æ˜“ç”¨**: åªéœ€æ›¿æ›Globalæ¨¡çµ„å°å…¥
- **å®Œå…¨å…¼å®¹**: èˆ‡ç¾¤ç›ŠAPIä»‹é¢å®Œå…¨ç›¸åŒ
- **ç©©å®šå¯é **: æ¯0.5ç§’ç©©å®šå ±åƒ¹æ¨é€
- **æ¸¬è©¦å‹å¥½**: 95%æˆäº¤ç‡é©åˆç­–ç•¥æ¸¬è©¦

ç¾åœ¨æ‚¨å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨è™›æ“¬å ±åƒ¹æ©Ÿæ¸¬è©¦simple_integrated.pyçš„ç­–ç•¥é‚è¼¯ï¼Œç„¡éœ€æ“”å¿ƒå½±éŸ¿çœŸå¯¦äº¤æ˜“ç’°å¢ƒï¼

---
*è™›æ“¬å ±åƒ¹æ©Ÿ v1.0*  
*æœ€å¾Œæ›´æ–°: 2025-01-13*
