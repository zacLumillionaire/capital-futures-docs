# 虛擬報價機配置使用說明

## 📋 配置文件總覽

| 配置文件 | 測試場景 | 主要特點 | 適用測試 |
|---------|---------|---------|---------|
| `config_entry_test.json` | 建倉測試 | 穩定價格、高成交率 | 進場邏輯、建倉流程 |
| `config_entry_chase.json` | 建倉追價測試 | 快速變動、需要追價 | 追價機制、部分成交 |
| `config_trailing_stop.json` | 移動停利測試 | 趨勢性變動、獲利累積 | 移動停利啟動、平倉 |
| `config_stop_loss.json` | 停損測試 | 逆向變動、觸發停損 | 停損機制、風險控制 |
| `config_stop_chase.json` | 停損追價測試 | 快速惡化、追價停損 | 停損追價、滑價控制 |
| `config_stress_test.json` | 綜合壓力測試 | 極端環境、系統壓力 | 系統穩定性、異常處理 |

## 🚀 快速切換方法

### 方法1：使用批處理腳本 (推薦)
```bash
# 在虛擬報價機目錄執行
quick_switch.bat
```
- 最快速的切換方式
- 適合頻繁切換測試

### 方法2：使用Python切換工具
```bash
# 在虛擬報價機目錄執行
python switch_config.py
```
- 功能最完整
- 支援備份和還原
- 適合詳細管理

### 方法3：手動複製 (基礎方式)
```bash
# 例如切換到建倉測試
copy config_entry_test.json config.json
```

## 📊 各配置詳細說明

### 1. 建倉測試配置 (`config_entry_test.json`)
**適用場景**：測試基本進場建倉邏輯
- **價格穩定性**：波動範圍 ±10點
- **成交機率**：95% (高成交率)
- **報價間隔**：0.5秒
- **買賣價差**：2點
- **測試重點**：
  - 進場信號觸發
  - 建倉流程完整性
  - 基本訂單處理

### 2. 建倉追價測試配置 (`config_entry_chase.json`)
**適用場景**：測試追價機制和部分成交處理
- **價格變動**：波動範圍 ±30點，有趨勢
- **成交機率**：70% (模擬追價需求)
- **報價間隔**：0.3秒 (快速變動)
- **買賣價差**：5點
- **測試重點**：
  - 追價邏輯正確性
  - 部分成交處理
  - 價格跳空應對

### 3. 移動停利測試配置 (`config_trailing_stop.json`)
**適用場景**：測試移動停利啟動和平倉機制
- **價格趨勢**：明顯上升趨勢，波動範圍 ±80點
- **成交機率**：90%
- **報價間隔**：0.8秒
- **特殊功能**：
  - 趨勢模擬 (30%強度)
  - 回撤模擬 (20%機率)
  - 獲利目標：15/40/65點
- **測試重點**：
  - 移動停利啟動條件
  - 峰值追蹤準確性
  - 回撤觸發機制

### 4. 停損測試配置 (`config_stop_loss.json`)
**適用場景**：測試停損觸發和執行
- **價格趨勢**：下降趨勢 (-20%強度)
- **成交機率**：85%
- **波動範圍**：±60點
- **特殊功能**：
  - 逆向模擬
  - 波動率突增
  - 跳空機率 10%
- **測試重點**：
  - 停損觸發準確性
  - 區間邊界停損
  - 保護性停損更新

### 5. 停損追價測試配置 (`config_stop_chase.json`)
**適用場景**：測試極端情況下的停損追價
- **價格趨勢**：快速下跌 (-40%強度)
- **成交機率**：60% (模擬流動性不足)
- **報價間隔**：0.2秒 (極快變動)
- **買賣價差**：8點 (模擬流動性緊張)
- **特殊功能**：
  - 流動性危機模擬
  - 跳空下跌 20%機率
  - 最多5次追價嘗試
- **測試重點**：
  - 停損追價邏輯
  - 滑價容忍度
  - 極端情況處理

### 6. 綜合壓力測試配置 (`config_stress_test.json`)
**適用場景**：系統穩定性和極限測試
- **價格變動**：極端波動 ±150點
- **成交機率**：50% (高難度)
- **報價間隔**：0.1秒 (極高頻)
- **買賣價差**：10點
- **特殊功能**：
  - 隨機跳空
  - 流動性衝擊
  - 網路延遲模擬
  - 部分成交 40%機率
- **測試重點**：
  - 系統穩定性
  - 異常處理能力
  - 性能極限測試

## 🔧 使用流程建議

### 開發階段測試順序
1. **建倉測試** → 確保基本功能正常
2. **建倉追價測試** → 驗證追價邏輯
3. **移動停利測試** → 測試獲利機制
4. **停損測試** → 驗證風險控制
5. **停損追價測試** → 測試極端風控
6. **綜合壓力測試** → 最終穩定性驗證

### 快速開發工作流
```bash
# 1. 切換到建倉測試配置
quick_switch.bat → 選擇 1

# 2. 啟動虛擬交易系統
cd ..
python virtual_simple_integrated.py

# 3. 測試完成後切換下一個配置
# 停止系統 → 切換配置 → 重啟系統
```

## 💡 配置自定義

### 修改現有配置
1. 直接編輯對應的 JSON 文件
2. 重啟虛擬報價機應用配置

### 創建新配置
1. 複製現有配置文件
2. 修改參數和場景描述
3. 在 `switch_config.py` 中添加新選項

### 重要參數說明
- `base_price`: 基準價格
- `price_range`: 價格波動範圍
- `spread`: 買賣價差
- `quote_interval`: 報價間隔(秒)
- `fill_probability`: 成交機率
- `volatility`: 波動率
- `trend_factor`: 趨勢因子 (-1到1)

## 🎯 測試建議

1. **循序漸進**：從簡單配置開始測試
2. **重點關注**：根據開發重點選擇對應配置
3. **壓力測試**：定期使用壓力測試配置驗證穩定性
4. **備份配置**：重要配置及時備份
5. **日誌分析**：每個配置都有對應的日誌文件

## 🚨 注意事項

1. **重啟生效**：切換配置後必須重啟虛擬報價機
2. **備份重要**：測試前備份當前配置
3. **環境隔離**：確保使用測試資料庫
4. **監控資源**：壓力測試時注意系統資源使用
5. **日誌檢查**：測試後檢查相關日誌文件
